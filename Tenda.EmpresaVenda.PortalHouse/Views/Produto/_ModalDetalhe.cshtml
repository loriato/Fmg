@using Europa.Resources
@model Tenda.EmpresaVenda.ApiService.Models.Produto.DetalheProdutoDto

@{
    var primeiroArquivo = Model.Arquivos.Count > 0 ? Model.Arquivos[0] : null;
    var primeiroArquivoIsVideo = primeiroArquivo?.IsVideo() ?? false;
}

<div class="modal transparent-modal" id="modal_produtos" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" data-backdrop="static">
    <div class="modal-dialog modal-xl" role="document">
        <div class="modal-content">
            <div class="modal-header modal-cyan">
                <div class="pl-5">
                    <span id="produto-nome" class="modal-title">@Model.Nome</span><br/>
                    <span id="produto-bairro" class="modal-subtitle">@Model.Bairro</span>
                </div>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close" onclick="Europa.Controllers.Produto.FecharModal()">
                    <img src="~/Static/svg/x-roxo.svg"/>
                </button>
            </div>
            <div class="modal-body color-blue">
                <div class="buttons-book">
                    <button style="margin-right: 27px" class="button__red__outline px-5 ml-3 float-right"
                            onclick="Europa.Controllers.Produto.SalvarBook(@(Model.EmpreendimentoVerificado ? Model.IdEmpreendimento : Model.Id), @Model.EmpreendimentoVerificado.ToString().ToLower())">
                        @GlobalMessages.Book
                    </button>
                    <button class="button__red__outline px-3 float-right" onclick="Europa.Controllers.Produto.AbrirModalPlanta()">
                        <img id="bnt-planta" src="~/Static/images/planta-icon1.svg" style="width: 35px; height: 20px;"/>
                        @GlobalMessages.Planta3D
                    </button>
                </div>
                <div>
                    <div class="div-img-style">
                        <span>@GlobalMessages.Imagens.ToUpper()</span>
                    </div>
                    @if (Model.Arquivos.Count > 0)
                    {
                        <div style="margin-left: 3%;width:95%">
                            <div class="div-exibir-img">
                                <div>
                                    <iframe id="video-detail" style="width: 100%; display: @(primeiroArquivoIsVideo ? "block" : "none");" height="300"
                                            src="@("https://www.youtube.com/embed/" + primeiroArquivo.Nome)" frameborder="0"
                                            allow="autoplay; encrypted-media" allowfullscreen>
                                    </iframe>

                                    <img style="width: 100%; height: 100%; min-height: 150px; max-height: 300px; display: @(!primeiroArquivoIsVideo ? "block" : "none");"
                                         id="img-zoom" src="@primeiroArquivo.Url" alt=""/>
                                </div>
                                <div id="div-imgs">
                                    <div class="grid-imgs-book">
                                        @for (var i = 0; i < Model.Arquivos.Count; i = i + 2)
                                        {
                                            var arquivo = Model.Arquivos[i];
                                            <div onclick="Europa.Controllers.Produto.SelecionarImg(
                                                '@arquivo.ContentType','@arquivo.Url', '@arquivo.Nome')">
                                                <img class="thumbnail" src="@arquivo.Url"/>
                                                @if (arquivo.IsVideo())
                                                {
                                                    <div class="thumbnail video-thumbnail-overlay">
                                                        <span class="fa fa-youtube-play"> </span>
                                                    </div>
                                                }
                                            </div>
                                        }
                                    </div>
                                </div>
                            </div>
                            <div class="div-btn-imgs">
                                <div>
                                    <span style="color: var(--slate);font-size:15px;font-weight:500">
                                        @GlobalMessages.ImagemIlustrativa
                                    </span>
                                </div>
                                <div>
                                    @if (Model.Arquivos.Count > 4)
                                    {
                                        <img id="previImg"
                                             onclick="Europa.Controllers.Produto.VoltarImg()"
                                             src="~/Static/svg/arrow-square-left-blue.svg"/>
                                        <img id="nextImg"
                                             onclick="Europa.Controllers.Produto.ProxImg()"
                                             src="~/Static/svg/arrow-square-right-blue.svg"/>
                                    }
                                </div>
                            </div>
                        </div>
                    }
                    else
                    {
                        <div style="margin-left: 4%; margin-top: 10px; width: 90%;">
                            <span style="color: var(--slate);font-size:17px;">
                                @GlobalMessages.NaoExisteImagens
                            </span>
                        </div>
                    }
                    <div class="div-detalhe-imov">
                        <div>
                            <span>@GlobalMessages.DetalhesImovel.ToUpper()</span>
                        </div>
                        <div>
                            <span>
                                @Model.Informacoes
                            </span>
                        </div>
                    </div>
                    <div class="div-ficha-tecnica">
                        <div>
                            <span>@GlobalMessages.FichaTecnica.ToUpper()</span>
                        </div>
                        <div>
                            <span>
                                @Model.FichaTecnica
                            </span>
                        </div>
                    </div>
                    <div class="div-endereco">
                        <div>
                            <span>@GlobalMessages.Endereco.ToUpper()</span>
                        </div>
                        <div>
                            <span>
                                @Model.FormatarEndereco()
                            </span>
                        </div>
                    </div>
                </div>
                <div class="div-pre-proposta-btn">
                    @using (Html.BeginForm("Index", "PreProposta", FormMethod.Post))
                    {
                        @Html.TextBoxFor(x => x.Id, new {Id = "idEmpre", Name = "idEmpre", @class = "oculto"})
                        <button type="submit" class="button__gradient px-3" title="@GlobalMessages.BtnPreProposta">@GlobalMessages.BtnPreProposta.ToUpper()</button>
                    }
                </div>
            </div>
        </div>
    </div>
</div>

<form id="form_exportar" hidden>
    <input name="idBl" id="idBl"/>
</form>

<script>
    $(".btn-planta").hover(function () {
        $("#bnt-planta").attr("src", "./Static/images/planta-icon2.svg");
    }, function () {
        $("#bnt-planta").attr("src", "./Static/images/planta-icon1.svg");
    })
</script>